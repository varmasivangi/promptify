

<div class="chat-area px-3 py-2" aria-live="polite">

  <div class="container">
    <div
      *ngFor="let m of messages; let i = index"
      class="msg"
      [class.user]="m.role === 'user'"
    >

      <div class="meta">
        <strong>{{ m.role }}</strong> • {{ m.ts | date : "shortTime" }} •
        <em>{{ m.provider || "unknown" }}</em>
      </div>

      <div class="actions">
        <button
          (click)="onCopy(m.text)"
          class="btn p-0 border-0 bg-transparent"
        >
          <i class="bi bi-copy"></i>
        </button>

        <button (click)="startEdit(i)" class="btn p-0 border-0 bg-transparent">
          <i class="bi bi-pencil-square ms-1"></i>
        </button>
      </div>

     
      <div *ngIf="editingIndex === i; else viewMode">
        <textarea
          [(ngModel)]="editText"
          rows="2"
          class="form-control mb-2"
        ></textarea>
        <button class="btn btn-sm   me-1" (click)="saveEdit(i)">
          Send
        </button>
        <button class="btn btn-sm " (click)="cancelEdit()">
          Cancel
        </button>
      </div>

      
      <ng-template #viewMode>
        <div class="body">{{ m.text }}</div>
      </ng-template>
    </div>

    <div *ngIf="loading" class="loading">Generating...</div>
  </div>
</div>
