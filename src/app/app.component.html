<header
  class="topbar d-flex justify-content-between align-items-center p-3 text-white"
  style="position: sticky; top: 0; z-index: 100; background-color: transparent"
>
  <h1 class="title mb-0">
    <img src="/promptify-logo-removebg-preview.png" alt="" width="180px" />
  </h1>

  <button
    class="menu-btn"
    (click)="toggleSidebar()"
    [class.open]="!sidebarCollapsed"
  >
    <span></span><span></span><span></span>
  </button>
</header>

<div class="d-flex">
  <!-- Sidebar -->
   <aside class="sidebar panel" [class.collapsed]="sidebarCollapsed">
  <div class="sidebar-inner">

    <!-- Model Selector -->
    <app-model-selector
      [models]="models"
      [selected]="selectedModel"
      (select)="getSelectedModel($event)"
    ></app-model-selector>

    <hr />

    <!-- Parameters -->
    <app-parameters-panel
      [(temperature)]="temperature"
      [(maxTokens)]="maxTokens"
      class="mt-3"
    ></app-parameters-panel>

    <hr />

    <!-- Templates -->
    <h5 class="templates-title" *ngIf="objectKeys(templates).length">Templates</h5>
    <div *ngFor="let k of objectKeys(templates)">
      <button
        class="template-btn"
        (click)="promptEditor.loadTemplate(templates[k])"
      >
        <span class="template-name">{{ k }}</span>
        <span class="template-arrow">âžœ</span>
      </button>
    </div>

    <hr *ngIf="objectKeys(templates).length" />


    <hr />

    <!-- Theme Toggle -->
    <div class="theme-toggle-row">
      <span>Theme</span>
      <app-theme-toggle></app-theme-toggle>
    </div>

  </div>
</aside>


<main class="main-content flex-grow-1 d-flex flex-wrap">
  <div 
    [ngClass]="isDocumentAnalyzerOpen ? 'col-lg-6 col-12' : 'col-12'" 
    class="d-flex flex-column justify-content-between"
    style="height: calc(100vh - 84.74px);"
  >
    <app-chat-output
      [messages]="messages"
      [loading]="loading"
      (download)="onDownload()"
      (copy)="onCopy($event)"
      (send)="onSend($event)"
    ></app-chat-output>

    <app-prompt-editor
      #promptEditor
      (send)="onSend($event)"
      (saveTemplate)="onSaveTemplate($event.name, $event.text)"
      (toggleDocumentAnalyzer)="openDocumentAnalyzer()"
      (downloadJSON)="onDownload()"
      [loading]="loading"
      class="mb-2 me-2 px-3"
    ></app-prompt-editor>
  </div>

  <div 
    *ngIf="isDocumentAnalyzerOpen" 
    class="col-lg-6 col-12"
  >
    <app-doc-analyzer
      (pdfDataChange)="onPdfDataReceived($event)"
      (toggleDocumentAnalyzer)="openDocumentAnalyzer()"
    ></app-doc-analyzer>
  </div>
</main>

</div>
